-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  d:\Dropbox\T\projects\ritest\tests\Stata\colombia_mcp.log
  log type:  text
 opened on:   4 Jun 2025, 13:40:16

. // edited by tabarecapitan.com
. // downloaded 2025-06-03
. 
. 
. ***** Examples using ritest to try it out *************
. *** Used in Development Impact blogpost
. 
. **** Example 1: McKenzie (2017, AER, Business Plan Competition)
. // use "Nigeriablogdata.dta", clear
. 
. // * Truncated profits in round 2
. // * Specification in paper
. // areg s_prof_trunc assigntreat, a(strata) robust
. // * RI test with 1000 replications 
. // ritest assigntreat _b[assigntreat], reps(1000) seed(125) strata(strata): a
> reg s_prof_trunc assigntreat, a(strata) robust
. // ritest assigntreat _b[assigntreat], reps(5000) strata(strata) seed(123): a
> reg s_prof_trunc assigntreat, a(strata) robust
. 
. // * Example 2: panel data regression, to illustrate clustering at individual
>  level with repeated measures.
. // ***** Pooling Round 2 and Round 3 post-treatment data ******************
. // gen prof_trunc2=s_prof_trunc
. // gen prof_trunc3=t_prof_trunc
. // gen uid=_n
. // keep uid prof_trunc2 prof_trunc3 group existing assigntreat strata
. // reshape long prof_trunc ,i(uid) j(time) 
. 
. // gen time3=time==3
. 
. // areg prof_trunc assigntreat time3 if group<=2 & existing==1, a(strata) rob
> ust cluster(uid)
. // ritest assigntreat _b[assigntreat], reps(1000) strata(strata) cluster(uid)
>  seed(124): areg prof_trunc assigntreat time3 if group<=2 & existing==1, a(st
> rata) robust cluster(uid)
. // ritest assigntreat _b[assigntreat], reps(5000) strata(strata) cluster(uid)
>  seed(124): areg prof_trunc assigntreat time3 if group<=2 & existing==1, a(st
> rata) robust cluster(uid)
. 
. 
. **** Example 3: Iacovone and McKenzie on supply chain shortening - clustered 
> randomization, with 63 clusters
. 
. cd "D:/Dropbox/T/projects/ritest/tests/data/"
D:\Dropbox\T\projects\ritest\tests\data

. 
. use "clusterColombia.dta", clear

. 
. count
  3,366

. 
. export delimited using "colombia.csv", replace // for Python tests
file colombia.csv saved

. 
. 
. 
. areg dayscorab b_treat b_dayscorab miss_b_dayscorab round2 round3, cluster(b_
> block) a(b_pair)

Linear regression, absorbing indicators             Number of obs     =  2,346
Absorbed variable: b_pair                           No. of categories =     31
                                                    F(5, 62)          =  99.28
                                                    Prob > F          = 0.0000
                                                    R-squared         = 0.2928
                                                    Adj R-squared     = 0.2820
                                                    Root MSE          = 1.9265

                               (Std. err. adjusted for 63 clusters in b_block)
------------------------------------------------------------------------------
             |               Robust
   dayscorab | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     b_treat |   -.180738   .0781737    -2.31   0.024     -.337005   -.0244711
 b_dayscorab |    .524761   .0294235    17.83   0.000     .4659443    .5835777
miss_b_day~b |   .6039278   .2641738     2.29   0.026     .0758519    1.132004
      round2 |  -.1294356   .1089608    -1.19   0.239    -.3472452     .088374
      round3 |  -.1652013   .1037462    -1.59   0.116     -.372587    .0421843
       _cons |   2.422814   .1650774    14.68   0.000     2.092829    2.752799
------------------------------------------------------------------------------

. 
. timer clear     

. timer on 1      

. 
. ritest b_treat _b[b_treat], reps(5000) cluster(b_block) strata(b_pair) seed(5
> 46): areg dayscorab b_treat b_dayscorab miss_b_dayscorab round2 round3, clust
> er(b_block) a(b_pair)
(running areg on estimation sample)

Linear regression, absorbing indicators             Number of obs     =  2,346
Absorbed variable: b_pair                           No. of categories =     31
                                                    F(5, 62)          =  99.28
                                                    Prob > F          = 0.0000
                                                    R-squared         = 0.2928
                                                    Adj R-squared     = 0.2820
                                                    Root MSE          = 1.9265

                               (Std. err. adjusted for 63 clusters in b_block)
------------------------------------------------------------------------------
             |               Robust
   dayscorab | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     b_treat |   -.180738   .0781737    -2.31   0.024     -.337005   -.0244711
 b_dayscorab |    .524761   .0294235    17.83   0.000     .4659443    .5835777
miss_b_day~b |   .6039278   .2641738     2.29   0.026     .0758519    1.132004
      round2 |  -.1294356   .1089608    -1.19   0.239    -.3472452     .088374
      round3 |  -.1652013   .1037462    -1.59   0.116     -.372587    .0421843
       _cons |   2.422814   .1650774    14.68   0.000     2.092829    2.752799
------------------------------------------------------------------------------

Resampling replications (5,000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
.................................................. 1,000
.................................................. 1,050
.................................................. 1,100
.................................................. 1,150
.................................................. 1,200
.................................................. 1,250
.................................................. 1,300
.................................................. 1,350
.................................................. 1,400
.................................................. 1,450
.................................................. 1,500
.................................................. 1,550
.................................................. 1,600
.................................................. 1,650
.................................................. 1,700
.................................................. 1,750
.................................................. 1,800
.................................................. 1,850
.................................................. 1,900
.................................................. 1,950
.................................................. 2,000
.................................................. 2,050
.................................................. 2,100
.................................................. 2,150
.................................................. 2,200
.................................................. 2,250
.................................................. 2,300
.................................................. 2,350
.................................................. 2,400
.................................................. 2,450
.................................................. 2,500
.................................................. 2,550
.................................................. 2,600
.................................................. 2,650
.................................................. 2,700
.................................................. 2,750
.................................................. 2,800
.................................................. 2,850
.................................................. 2,900
.................................................. 2,950
.................................................. 3,000
.................................................. 3,050
.................................................. 3,100
.................................................. 3,150
.................................................. 3,200
.................................................. 3,250
.................................................. 3,300
.................................................. 3,350
.................................................. 3,400
.................................................. 3,450
.................................................. 3,500
.................................................. 3,550
.................................................. 3,600
.................................................. 3,650
.................................................. 3,700
.................................................. 3,750
.................................................. 3,800
.................................................. 3,850
.................................................. 3,900
.................................................. 3,950
.................................................. 4,000
.................................................. 4,050
.................................................. 4,100
.................................................. 4,150
.................................................. 4,200
.................................................. 4,250
.................................................. 4,300
.................................................. 4,350
.................................................. 4,400
.................................................. 4,450
.................................................. 4,500
.................................................. 4,550
.................................................. 4,600
.................................................. 4,650
.................................................. 4,700
.................................................. 4,750
.................................................. 4,800
.................................................. 4,850
.................................................. 4,900
.................................................. 4,950
.................................................. 5,000

      Command: areg dayscorab b_treat b_dayscorab miss_b_dayscorab round2
                   round3, cluster(b_block) a(b_pair)
        _pm_1: _b[b_treat]
  res. var(s):  b_treat
   Resampling:  Permuting b_treat
Clust. var(s):  b_block
     Clusters:  63
Strata var(s):  b_pair
       Strata:  31

------------------------------------------------------------------------------
T            |     T(obs)       c       n   p=c/n   SE(p) [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _pm_1 |   -.180738     495    5000  0.0990  0.0042  .0908575    .107614
------------------------------------------------------------------------------
Note: Confidence interval is with respect to p=c/n.
Note: c = #{|T| >= |T(obs)|}

. 
. timer off 1     

. timer list 1    
   1:    313.37 /        1 =     313.3710

. 
. 
. // * using the t-stat instead of coefficient for comparison
. // ritest b_treat _b[b_treat]/_se[b_treat], reps(5000) cluster(b_block) strat
> a(b_pair) seed(546): areg dayscorab b_treat b_dayscorab miss_b_dayscorab roun
> d2 round3, cluster(b_block) a(b_pair)
. 
. 
. 
. capture log close _all
